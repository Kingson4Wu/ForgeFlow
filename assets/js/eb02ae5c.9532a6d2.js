"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[822],{6127:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"advanced-patterns","title":"CLI Adapters","description":"CLI Adapters are a core component of ForgeFlow that enable support for different AI CLI tools through a consistent interface. They implement the adapter pattern to provide a uniform way to interact with various AI tools while handling their specific behaviors and requirements.","source":"@site/docs/advanced-patterns.md","sourceDirName":".","slug":"/advanced-patterns","permalink":"/ForgeFlow/docs/advanced-patterns","draft":false,"unlisted":false,"editUrl":"https://github.com/kingson4wu/ForgeFlow/edit/main/documentation/docs/advanced-patterns.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"Task Types","permalink":"/ForgeFlow/docs/deployment"},"next":{"title":"Custom Project Setup","permalink":"/ForgeFlow/docs/tutorial-basics/create-a-page"}}');var r=n(4848),s=n(8453);const a={sidebar_position:6},l="CLI Adapters",o={},d=[{value:"Adapter Pattern Implementation",id:"adapter-pattern-implementation",level:2},{value:"Base CLIAdapter Interface",id:"base-cliadapter-interface",level:2},{value:"Available Adapters",id:"available-adapters",level:2},{value:"Gemini Adapter",id:"gemini-adapter",level:3},{value:"Qwen Adapter",id:"qwen-adapter",level:3},{value:"Claude Code Adapter",id:"claude-code-adapter",level:3},{value:"Using Different CLI Adapters",id:"using-different-cli-adapters",level:2},{value:"Creating Custom Adapters",id:"creating-custom-adapters",level:2},{value:"Adapter Factory",id:"adapter-factory",level:2},{value:"Adapter-Specific Features",id:"adapter-specific-features",level:2},{value:"Regular Expression Detection",id:"regular-expression-detection",level:3},{value:"ANSI Handling",id:"ansi-handling",level:3},{value:"Session Management",id:"session-management",level:3},{value:"Advanced Adapter Techniques",id:"advanced-adapter-techniques",level:2},{value:"Multi-Line Prompt Detection",id:"multi-line-prompt-detection",level:3},{value:"Stateful Detection",id:"stateful-detection",level:3},{value:"Default Rules for CLI Types",id:"default-rules-for-cli-types",level:2}];function c(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"cli-adapters",children:"CLI Adapters"})}),"\n",(0,r.jsx)(t.p,{children:"CLI Adapters are a core component of ForgeFlow that enable support for different AI CLI tools through a consistent interface. They implement the adapter pattern to provide a uniform way to interact with various AI tools while handling their specific behaviors and requirements."}),"\n",(0,r.jsx)(t.h2,{id:"adapter-pattern-implementation",children:"Adapter Pattern Implementation"}),"\n",(0,r.jsx)(t.p,{children:"The CLI adapter system uses the classic adapter pattern with a base class and specific implementations:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Base Interface"}),": ",(0,r.jsx)(t.code,{children:"CLIAdapter"})," (defined in ",(0,r.jsx)(t.code,{children:"forgeflow/core/cli_adapters/base.py"}),")"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Concrete Implementations"}),": Specific adapters for different AI tools"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Factory"}),": Creates appropriate adapters based on CLI type"]}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"base-cliadapter-interface",children:"Base CLIAdapter Interface"}),"\n",(0,r.jsxs)(t.p,{children:["All CLI adapters inherit from the ",(0,r.jsx)(t.code,{children:"CLIAdapter"})," base class which defines the following interface:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-python",children:'class CLIAdapter(ABC):\n    @abstractmethod\n    def is_input_prompt(self, output: str) -> bool:\n        """Detects if the AI CLI is waiting for input"""\n        pass\n\n    @abstractmethod\n    def is_input_prompt_with_text(self, output: str) -> tuple[bool, str]:\n        """Detects if there\'s existing text in the input box"""\n        pass\n\n    @abstractmethod\n    def is_task_processing(self, output: str) -> bool:\n        """Detects if the AI is actively processing a task"""\n        pass\n\n    @abstractmethod\n    def is_ai_cli_exist(self) -> bool:\n        """Checks if the CLI tool is available"""\n        pass\n\n    def wants_ansi(self) -> bool:\n        """Indicates if CLI wants ANSI output (default True)"""\n        return True\n'})}),"\n",(0,r.jsx)(t.h2,{id:"available-adapters",children:"Available Adapters"}),"\n",(0,r.jsx)(t.h3,{id:"gemini-adapter",children:"Gemini Adapter"}),"\n",(0,r.jsx)(t.p,{children:"The default adapter for Google's Gemini CLI tool:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Located in ",(0,r.jsx)(t.code,{children:"forgeflow/core/cli_adapters/gemini.py"})]}),"\n",(0,r.jsx)(t.li,{children:"Implements prompt detection for Gemini's interface"}),"\n",(0,r.jsx)(t.li,{children:"Handles Gemini-specific input and processing patterns"}),"\n",(0,r.jsxs)(t.li,{children:["Default adapter if no ",(0,r.jsx)(t.code,{children:"--cli-type"})," is specified"]}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"qwen-adapter",children:"Qwen Adapter"}),"\n",(0,r.jsx)(t.p,{children:"Adapter for Alibaba Cloud's Qwen CLI tool:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Located in ",(0,r.jsx)(t.code,{children:"forgeflow/core/cli_adapters/qwen.py"})]}),"\n",(0,r.jsx)(t.li,{children:"Implements prompt detection for Qwen's interface"}),"\n",(0,r.jsx)(t.li,{children:"Handles Qwen-specific response patterns"}),"\n",(0,r.jsx)(t.li,{children:"Used when working with Qwen as the AI CLI tool"}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"claude-code-adapter",children:"Claude Code Adapter"}),"\n",(0,r.jsx)(t.p,{children:"Placeholder implementation for Anthropic's Claude Code:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Located in ",(0,r.jsx)(t.code,{children:"forgeflow/core/cli_adapters/claude_code.py"})]}),"\n",(0,r.jsx)(t.li,{children:"Currently a placeholder that needs implementation"}),"\n",(0,r.jsx)(t.li,{children:"Intended to support Claude Code's specific behaviors"}),"\n",(0,r.jsx)(t.li,{children:"Can be extended for full Claude support"}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"using-different-cli-adapters",children:"Using Different CLI Adapters"}),"\n",(0,r.jsxs)(t.p,{children:["To specify a CLI adapter type, use the ",(0,r.jsx)(t.code,{children:"--cli-type"})," parameter:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"# Using the default Gemini adapter (explicitly specified)\nforgeflow --cli-type gemini [other parameters]\n\n# Using the Qwen adapter\nforgeflow --cli-type qwen [other parameters]\n\n# Using the Claude Code adapter\nforgeflow --cli-type claude_code [other parameters]\n"})}),"\n",(0,r.jsx)(t.h2,{id:"creating-custom-adapters",children:"Creating Custom Adapters"}),"\n",(0,r.jsxs)(t.p,{children:["To create a custom adapter for a new AI CLI tool, implement the ",(0,r.jsx)(t.code,{children:"CLIAdapter"})," interface:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-python",children:'# Example custom adapter implementation\nfrom forgeflow.core.cli_adapters.base import CLIAdapter\n\nclass CustomAdapter(CLIAdapter):\n    def is_input_prompt(self, output: str) -> bool:\n        # Implementation for detecting input prompts\n        return "custom_prompt>" in output.split(\'\\n\')[-1]\n\n    def is_input_prompt_with_text(self, output: str) -> tuple[bool, str]:\n        # Implementation for detecting existing text\n        lines = output.split(\'\\n\')\n        if lines and "custom_prompt>" in lines[-1]:\n            # Extract any pre-filled text if present\n            return True, ""\n        return False, ""\n\n    def is_task_processing(self, output: str) -> bool:\n        # Implementation for detecting task processing\n        return "processing..." in output.lower()\n\n    def is_ai_cli_exist(self) -> bool:\n        # Check if the CLI is available\n        import subprocess\n        try:\n            result = subprocess.run([\'custom-cli\', \'--version\'], \n                                  capture_output=True, text=True, timeout=5)\n            return result.returncode == 0\n        except:\n            return False\n'})}),"\n",(0,r.jsx)(t.h2,{id:"adapter-factory",children:"Adapter Factory"}),"\n",(0,r.jsx)(t.p,{children:"The factory pattern implementation automatically creates the appropriate adapter based on the CLI type:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-python",children:"from forgeflow.core.cli_adapters.factory import get_cli_adapter\n\n# Creates the appropriate adapter based on CLI type\nadapter = get_cli_adapter(cli_type='qwen')\n"})}),"\n",(0,r.jsx)(t.h2,{id:"adapter-specific-features",children:"Adapter-Specific Features"}),"\n",(0,r.jsx)(t.h3,{id:"regular-expression-detection",children:"Regular Expression Detection"}),"\n",(0,r.jsx)(t.p,{children:"Adapters use regular expressions to detect specific patterns in CLI output:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Input prompts: Different CLIs have different prompt indicators"}),"\n",(0,r.jsx)(t.li,{children:"Existing text: Detection of text already in the input field"}),"\n",(0,r.jsx)(t.li,{children:"Task processing: Identifying when the AI is actively working"}),"\n",(0,r.jsx)(t.li,{children:"Error states: Recognizing error conditions"}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"ansi-handling",children:"ANSI Handling"}),"\n",(0,r.jsxs)(t.p,{children:["Some CLIs handle ANSI codes differently. Adapters can specify if they want ANSI output via the ",(0,r.jsx)(t.code,{children:"wants_ansi()"})," method, which controls how output is formatted."]}),"\n",(0,r.jsx)(t.h3,{id:"session-management",children:"Session Management"}),"\n",(0,r.jsx)(t.p,{children:"Adapters handle the specific requirements for session management with different AI tools, including:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Command formatting"}),"\n",(0,r.jsx)(t.li,{children:"Response parsing"}),"\n",(0,r.jsx)(t.li,{children:"State tracking"}),"\n",(0,r.jsx)(t.li,{children:"Recovery procedures"}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"advanced-adapter-techniques",children:"Advanced Adapter Techniques"}),"\n",(0,r.jsx)(t.h3,{id:"multi-line-prompt-detection",children:"Multi-Line Prompt Detection"}),"\n",(0,r.jsx)(t.p,{children:"Some CLIs have complex multi-line prompts. Adapters can implement sophisticated detection logic:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-python",children:"def is_input_prompt(self, output: str) -> bool:\n    lines = output.strip().split('\\n')\n    if len(lines) >= 2:\n        return lines[-1].startswith('>') and 'custom' in lines[-2]\n    return lines[-1].startswith('custom-prompt>')\n"})}),"\n",(0,r.jsx)(t.h3,{id:"stateful-detection",children:"Stateful Detection"}),"\n",(0,r.jsx)(t.p,{children:"Some adapters maintain internal state to improve detection accuracy:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-python",children:'class StatefulAdapter(CLIAdapter):\n    def __init__(self):\n        self.previous_output = ""\n        \n    def is_task_processing(self, output: str) -> bool:\n        # Use both current output and previous state\n        is_processing = self._detect_processing(output)\n        self.previous_output = output\n        return is_processing\n'})}),"\n",(0,r.jsx)(t.h2,{id:"default-rules-for-cli-types",children:"Default Rules for CLI Types"}),"\n",(0,r.jsxs)(t.p,{children:["ForgeFlow includes default rules specific to each CLI type in the ",(0,r.jsx)(t.code,{children:"forgeflow/core/cli_types/"})," directory. These rules provide optimal interaction patterns for each AI CLI tool."]}),"\n",(0,r.jsx)(t.p,{children:"The adapter system makes ForgeFlow flexible and extensible, allowing support for multiple AI CLI tools while maintaining consistent automation behavior."})]})}function p(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>l});var i=n(6540);const r={},s=i.createContext(r);function a(e){const t=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(s.Provider,{value:t},e.children)}}}]);